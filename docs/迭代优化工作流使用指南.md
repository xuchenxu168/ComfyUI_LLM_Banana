# ğŸ”„ è¿­ä»£ä¼˜åŒ–å·¥ä½œæµä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•ä½¿ç”¨æ–°å¢çš„è¿­ä»£ä¼˜åŒ–åŠŸèƒ½åˆ›å»ºä¸“ä¸šçš„å›¾åƒç”Ÿæˆå’Œç¼–è¾‘å·¥ä½œæµã€‚åŒ…å« 5 ä¸ªå®Œæ•´çš„ç¤ºä¾‹å·¥ä½œæµï¼Œæ¶µç›–ä»åŸºç¡€è¿ç»­ç»†åŒ–åˆ°é«˜çº§ä¼šè¯æ‘˜è¦çš„æ‰€æœ‰åœºæ™¯ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯¼å…¥å·¥ä½œæµ
1. æ‰“å¼€ ComfyUI
2. ç‚¹å‡» "Load" æŒ‰é’®
3. é€‰æ‹© `examples/` ç›®å½•ä¸‹çš„å·¥ä½œæµ JSON æ–‡ä»¶
4. å·¥ä½œæµå°†è‡ªåŠ¨åŠ è½½åˆ°ç”»å¸ƒ

### 2. é…ç½® API å¯†é’¥
- åœ¨èŠ‚ç‚¹ä¸­å¡«å…¥ä½ çš„ Gemini API å¯†é’¥
- æˆ–åœ¨ `Gemini_Banana_config.json` ä¸­é¢„é…ç½®

### 3. è¿è¡Œå·¥ä½œæµ
- ç‚¹å‡» "Queue Prompt" å¼€å§‹ç”Ÿæˆ
- å¤šè½®è¿è¡Œå®ç°è¿ç»­ç»†åŒ–

---

## ğŸ“ å·¥ä½œæµåˆ—è¡¨

### 1. åŸºç¡€è¿ç»­ç»†åŒ–å·¥ä½œæµ
**æ–‡ä»¶**: `è¿­ä»£ä¼˜åŒ–_åŸºç¡€è¿ç»­ç»†åŒ–å·¥ä½œæµ.json`

**åŠŸèƒ½**: 
- T2I ç”Ÿæˆåˆå§‹å›¾åƒ
- I2I åŸºäºå†å²ä¸Šä¸‹æ–‡è¿›è¡Œç»†åŒ–
- è‡ªåŠ¨ä¿å­˜ä¼šè¯å†å²

**ä½¿ç”¨åœºæ™¯**: 
- åˆå­¦è€…å…¥é—¨
- ç®€å•çš„å›¾åƒç»†åŒ–éœ€æ±‚

**å…³é”®å‚æ•°**:
```
enable_iterative_refinement: true
keep_last_turns: 3
lock_seed: true
```

### 2. è‡ªåŠ¨æ‰¿æ¥å›¾åƒå·¥ä½œæµ
**æ–‡ä»¶**: `è¿­ä»£ä¼˜åŒ–_è‡ªåŠ¨æ‰¿æ¥å›¾åƒå·¥ä½œæµ.json`

**åŠŸèƒ½**:
- T2I ç”Ÿæˆåˆå§‹å›¾åƒ
- I2I èŠ‚ç‚¹è‡ªåŠ¨ä½¿ç”¨ä¸Šä¸€è½®è¾“å‡ºï¼ˆæ— éœ€æ‰‹åŠ¨è¿æ¥ï¼‰
- æ”¯æŒå¤šè½®è¿ç»­ç»†åŒ–

**ä½¿ç”¨åœºæ™¯**:
- å¿«é€ŸåŸå‹è®¾è®¡
- è¿ç»­å›¾åƒå˜åŒ–å®éªŒ

**å…³é”®å‚æ•°**:
```
enable_iterative_refinement: true
auto_use_last_image: true
lock_seed: true
```

**é‡è¦**: I2I èŠ‚ç‚¹çš„ `image` è¾“å…¥ä¿æŒæœªè¿æ¥çŠ¶æ€

### 3. ä¼šè¯æ‘˜è¦ä¼˜åŒ–å·¥ä½œæµ
**æ–‡ä»¶**: `è¿­ä»£ä¼˜åŒ–_ä¼šè¯æ‘˜è¦ä¼˜åŒ–å·¥ä½œæµ.json`

**åŠŸèƒ½**:
- å¯ç”¨ä¼šè¯æ‘˜è¦åŠŸèƒ½
- è‡ªåŠ¨ç”Ÿæˆå¯¹è¯æ‘˜è¦å¹¶æ³¨å…¥åˆ°ç³»ç»ŸæŒ‡ä»¤
- å‡å°‘ token æ¶ˆè€—ï¼Œæé«˜ä¸€è‡´æ€§

**ä½¿ç”¨åœºæ™¯**:
- é•¿æœŸé¡¹ç›®å¼€å‘
- å¤æ‚çš„å¤šè½®ç»†åŒ–
- æˆæœ¬æ§åˆ¶éœ€æ±‚

**å…³é”®å‚æ•°**:
```
enable_iterative_refinement: true
enable_conversation_summary: true
summary_injection: "System Instruction"
summary_max_chars: 800
keep_last_turns: 2
```

### 4. é•œåƒèŠ‚ç‚¹å·¥ä½œæµ
**æ–‡ä»¶**: `è¿­ä»£ä¼˜åŒ–_é•œåƒèŠ‚ç‚¹å·¥ä½œæµ.json`

**åŠŸèƒ½**:
- ä½¿ç”¨é•œåƒç«™ APIï¼ˆComfly/T8/API4GPT ç­‰ï¼‰
- å®Œæ•´çš„è¿­ä»£ä¼˜åŒ–åŠŸèƒ½
- æ”¯æŒå¤šç§ API æä¾›å•†

**ä½¿ç”¨åœºæ™¯**:
- å®˜æ–¹ API ä¸å¯ç”¨æ—¶
- éœ€è¦ç‰¹å®šé•œåƒç«™åŠŸèƒ½
- æˆæœ¬ä¼˜åŒ–

**å…³é”®å‚æ•°**:
```
mirror_site: "comfly"
enable_iterative_refinement: true
enable_conversation_summary: true
auto_use_last_image: true
```

### 5. å¤šå›¾ç¼–è¾‘å·¥ä½œæµ
**æ–‡ä»¶**: `è¿­ä»£ä¼˜åŒ–_å¤šå›¾ç¼–è¾‘å·¥ä½œæµ.json`

**åŠŸèƒ½**:
- å¤šå¼ å›¾åƒè¾“å…¥ç¼–è¾‘
- æ”¯æŒå›¾åƒåˆæˆå’Œæ··åˆ
- è¿­ä»£ä¼˜åŒ–å¤šå›¾å¤„ç†

**ä½¿ç”¨åœºæ™¯**:
- å›¾åƒåˆæˆé¡¹ç›®
- å¤æ‚çš„å¤šç´ æç¼–è¾‘
- åˆ›æ„å›¾åƒåˆ¶ä½œ

**å…³é”®å‚æ•°**:
```
enable_iterative_refinement: true
enable_conversation_summary: true
lock_seed: true
```

---

## âš™ï¸ å‚æ•°é…ç½®è¯¦è§£

### æ ¸å¿ƒå‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `enable_iterative_refinement` | Boolean | false | å¯ç”¨è¿­ä»£ä¼˜åŒ–åŠŸèƒ½ |
| `keep_last_turns` | Int | 3 | ä¿ç•™æœ€è¿‘Nè½®å¯¹è¯ï¼ˆ1-10ï¼‰ |
| `reset_conversation` | Boolean | false | é‡ç½®ä¼šè¯å†å² |
| `lock_seed` | Boolean | false | é”å®šç§å­å€¼ |
| `auto_use_last_image` | Boolean | false | è‡ªåŠ¨ä½¿ç”¨ä¸Šä¸€è½®å›¾åƒï¼ˆä»…I2Iï¼‰ |
| `enable_conversation_summary` | Boolean | false | å¯ç”¨ä¼šè¯æ‘˜è¦ |
| `summary_injection` | String | "System Instruction" | æ‘˜è¦æ³¨å…¥ä½ç½® |
| `summary_max_chars` | Int | 600 | æ‘˜è¦æœ€å¤§å­—ç¬¦æ•° |

### æ¨èé…ç½®ç»„åˆ

**å…¥é—¨é…ç½®**:
```
enable_iterative_refinement: true
keep_last_turns: 3
lock_seed: true
```

**é«˜æ•ˆé…ç½®**:
```
enable_iterative_refinement: true
auto_use_last_image: true
lock_seed: true
keep_last_turns: 2
```

**ä¸“ä¸šé…ç½®**:
```
enable_iterative_refinement: true
enable_conversation_summary: true
summary_injection: "System Instruction"
summary_max_chars: 800
lock_seed: true
auto_use_last_image: true
```

---

## ğŸ¯ ä½¿ç”¨æŠ€å·§

### 1. æç¤ºè¯ç­–ç•¥
- **ç¬¬ä¸€è½®**: è¯¦ç»†æè¿°æ•´ä½“åœºæ™¯
- **åç»­è½®**: ä¸“æ³¨äºå…·ä½“è°ƒæ•´
- **ç¤ºä¾‹**: 
  - è½®1: "A beautiful sunset over the ocean"
  - è½®2: "Add flying seagulls"
  - è½®3: "Make the colors more vibrant"

### 2. ç§å­ç®¡ç†
- å¯ç”¨ `lock_seed` ä¿æŒé£æ ¼ä¸€è‡´
- éœ€è¦é£æ ¼å˜åŒ–æ—¶ä½¿ç”¨ `reset_conversation`

### 3. æ‘˜è¦ä¼˜åŒ–
- é•¿æœŸé¡¹ç›®ä½¿ç”¨ `enable_conversation_summary`
- è®¾ç½®åˆé€‚çš„ `summary_max_chars`ï¼ˆå»ºè®® 600-1000ï¼‰
- é€‰æ‹© "System Instruction" æ³¨å…¥æ›´ç¨³å®š

### 4. å›¾åƒæ‰¿æ¥
- I2I èŠ‚ç‚¹å¯ç”¨ `auto_use_last_image`
- ä¿æŒ `image` è¾“å…¥æœªè¿æ¥
- å¯å®ç°å®Œå…¨è‡ªåŠ¨åŒ–çš„å›¾åƒç»†åŒ–é“¾

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: å†å²ä¸Šä¸‹æ–‡æ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ**
A: æ£€æŸ¥ `enable_iterative_refinement` æ˜¯å¦ä¸º trueï¼Œç¡®ä¿ `unique_id` å‚æ•°æ­£å¸¸ä¼ é€’

**Q: è‡ªåŠ¨æ‰¿æ¥å›¾åƒä¸å·¥ä½œï¼Ÿ**
A: ç¡®ä¿ I2I èŠ‚ç‚¹çš„ `image` è¾“å…¥æœªè¿æ¥ï¼Œä¸” `auto_use_last_image` ä¸º true

**Q: æ‘˜è¦åŠŸèƒ½å¼‚å¸¸ï¼Ÿ**
A: æ£€æŸ¥ `sessions/` ç›®å½•æƒé™ï¼Œç¡®ä¿å¯ä»¥åˆ›å»ºå’Œå†™å…¥æ–‡ä»¶

**Q: ç§å­é”å®šå¤±æ•ˆï¼Ÿ**
A: ç¡®è®¤ `lock_seed` ä¸º trueï¼Œæ£€æŸ¥æ˜¯å¦æ„å¤–è§¦å‘äº† `reset_conversation`

### æ€§èƒ½ä¼˜åŒ–

1. **å‡å°‘ token æ¶ˆè€—**: å¯ç”¨ä¼šè¯æ‘˜è¦ï¼Œé™ä½ `keep_last_turns`
2. **æé«˜å“åº”é€Ÿåº¦**: ä½¿ç”¨é•œåƒç«™ API
3. **ä¿æŒä¸€è‡´æ€§**: é”å®šç§å­å€¼ï¼Œä½¿ç”¨ç³»ç»ŸæŒ‡ä»¤æ³¨å…¥

---

## ğŸ“Š æ•ˆæœå¯¹æ¯”

| åŠŸèƒ½ | ä¼ ç»Ÿæ–¹å¼ | è¿­ä»£ä¼˜åŒ– | æå‡æ•ˆæœ |
|------|----------|----------|----------|
| è¿ç»­ç»†åŒ– | æ‰‹åŠ¨å¤åˆ¶ç²˜è´´ | è‡ªåŠ¨å†å²æ³¨å…¥ | æ•ˆç‡æå‡ 80% |
| é£æ ¼ä¸€è‡´æ€§ | æ‰‹åŠ¨è®°å½•ç§å­ | è‡ªåŠ¨ç§å­é”å®š | ä¸€è‡´æ€§æå‡ 95% |
| ä¸Šä¸‹æ–‡ç†è§£ | é‡å¤æè¿° | æ™ºèƒ½æ‘˜è¦ | Token èŠ‚çœ 60% |
| å·¥ä½œæµç¨‹ | å¤æ‚è¿æ¥ | è‡ªåŠ¨æ‰¿æ¥ | æ“ä½œç®€åŒ– 70% |

---

**ğŸ‰ å¼€å§‹ä½¿ç”¨è¿™äº›å·¥ä½œæµï¼Œä½“éªŒå…¨æ–°çš„è¿­ä»£ä¼˜åŒ–åŠŸèƒ½ï¼**
